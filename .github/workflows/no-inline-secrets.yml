# Fail the pipeline if compose files contain inline secret variable assignments.
# Does NOT print compose config (which would expose secrets).
name: No inline secrets in compose

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]

jobs:
  check-no-inline-secrets:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run inline-secrets regression tests
        run: bash tests/security/test_inline_secrets_checker.sh

      - name: Check no inline secrets in compose files
        run: bash scripts/aws/check_no_inline_secrets_in_compose.sh
