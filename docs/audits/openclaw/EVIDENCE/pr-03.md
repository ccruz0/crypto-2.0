# Evidence: PR3 â€” Terminal notifications (CANCELLED/EXPIRED/REJECTED) with idempotency

**Status:** Implemented.

## Goal

Every terminal transition (CANCELLED, EXPIRED, REJECTED) triggers notify_on_terminal_transition; duplicate sync events do not send duplicate Telegram (idempotent via last_notified_terminal_status).

## Commands

From repo root:

```bash
cd "$(git rev-parse --show-toplevel)"

python3 -m pytest backend/tests/test_terminal_order_notifier.py -v --tb=short
```

## Evidence capture

```bash
cd "$(git rev-parse --show-toplevel)"
mkdir -p docs/audits/openclaw/EVIDENCE/logs
python3 -m pytest backend/tests/test_terminal_order_notifier.py -v --tb=short 2>&1 | tee docs/audits/openclaw/EVIDENCE/logs/pr-03_$(date +%Y%m%d_%H%M%S).txt
```

## Expected outcome

- All tests in test_terminal_order_notifier.py pass (idempotency, CANCELLED/EXPIRED/REJECTED handling).

## Rollback check

If notify_on_terminal_transition is bypassed or idempotency is removed, these tests will fail.
